import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as c,c as o,a as n,b as a,d as e,f as r}from"./app-3f278ba4.js";const p={},l=r(`<h2 id="背景" tabindex="-1"><a class="header-anchor" href="#背景" aria-hidden="true">#</a> 背景</h2><ul><li>在测试运行时截图和录屏能够在测试错误时快速定位到问题所在</li><li>Cypress 截图和录屏功能强大</li></ul><p></p><h2 id="无须配置-自动截图" tabindex="-1"><a class="header-anchor" href="#无须配置-自动截图" aria-hidden="true">#</a> 无须配置，自动截图</h2><p>以 cypress run 方式运行测试时，当测试发生错误时，Cypress 会自动截图，并默认保存在 cypress/screenshots 文件夹下，而录屏会保存在 cypress/video 文件夹下</p><h4 id="命令行运行结果" tabindex="-1"><a class="header-anchor" href="#命令行运行结果" aria-hidden="true">#</a> 命令行运行结果</h4><p><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200927160810785-1360288750.png" alt="" loading="lazy"><br> console 会看到错误截图和录屏的生成路径</p><h4 id="生成截图和录屏的目录" tabindex="-1"><a class="header-anchor" href="#生成截图和录屏的目录" aria-hidden="true">#</a> 生成截图和录屏的目录</h4><figure><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200927160836191-218752750.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="自定义截图-screenshot-方法" tabindex="-1"><a class="header-anchor" href="#自定义截图-screenshot-方法" aria-hidden="true">#</a> 自定义截图，.screenshot() 方法</h2><h3 id="作用" tabindex="-1"><a class="header-anchor" href="#作用" aria-hidden="true">#</a> 作用</h3><p>截取被测应用程序的屏幕快照，以及 Cypress 命令日志的屏幕快照</p><h3 id="语法格式" tabindex="-1"><a class="header-anchor" href="#语法格式" aria-hidden="true">#</a> 语法格式</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
<span class="token comment">// ---or---</span>
cy<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
cy<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>
cy<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
cy<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p><h4 id="filename" tabindex="-1"><a class="header-anchor" href="#filename" aria-hidden="true">#</a> fileName</h4><ul><li>待保存图片的名称</li><li>图片默认保存在 cypress/screenshots 文件夹下，可以在 cypress.json 修改默认文件夹路径（配置项 screenshotsFolder ）</li></ul><p></p><h4 id="options-详解" tabindex="-1"><a class="header-anchor" href="#options-详解" aria-hidden="true">#</a> options 详解</h4><p><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200927191730584-578699108.png" alt="" loading="lazy"><br><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200927172204537-391158457.png" alt="" loading="lazy"><br> 通过 onBeforeScreenshot、onAfterScreenshot，可以在截图发生前或发生后应用自定义的行为</p><h3 id="正确用法" tabindex="-1"><a class="header-anchor" href="#正确用法" aria-hidden="true">#</a> 正确用法</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 直接截图整个页面</span>
cy<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 只截图某个特定元素</span>
cy<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;.post&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p><h3 id="命令返回结果" tabindex="-1"><a class="header-anchor" href="#命令返回结果" aria-hidden="true">#</a> 命令返回结果</h3><p>返回上一条命令相同的结果</p><h2 id="screenshot-栗子" tabindex="-1"><a class="header-anchor" href="#screenshot-栗子" aria-hidden="true">#</a> .screenshot() 栗子</h2><h4 id="测试代码" tabindex="-1"><a class="header-anchor" href="#测试代码" aria-hidden="true">#</a> 测试代码</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;简单的栗子&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 截图整个页面</span>
    cy<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p><h4 id="测试结果" tabindex="-1"><a class="header-anchor" href="#测试结果" aria-hidden="true">#</a> 测试结果</h4><p><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200927174221935-1002897527.png" alt="" loading="lazy"><br> 为什么截图这么长呢？<br> 因为 capture 默认值就是 fullpage，代表整个页面</p><h2 id="screenshot-filename-栗子" tabindex="-1"><a class="header-anchor" href="#screenshot-filename-栗子" aria-hidden="true">#</a> .screenshot(filename) 栗子</h2><h4 id="测试代码-1" tabindex="-1"><a class="header-anchor" href="#测试代码-1" aria-hidden="true">#</a> 测试代码</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;文件名&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cy<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token string">&#39;文件名&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p><h4 id="测试结果-1" tabindex="-1"><a class="header-anchor" href="#测试结果-1" aria-hidden="true">#</a> 测试结果</h4><figure><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200927174807830-1402396436.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="screenshot-options-栗子" tabindex="-1"><a class="header-anchor" href="#screenshot-options-栗子" aria-hidden="true">#</a> .screenshot(options) 栗子</h2><h3 id="capture-viewport-的栗子" tabindex="-1"><a class="header-anchor" href="#capture-viewport-的栗子" aria-hidden="true">#</a> capture:viewport 的栗子</h3><h4 id="测试代码-2" tabindex="-1"><a class="header-anchor" href="#测试代码-2" aria-hidden="true">#</a> 测试代码</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>cy<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     <span class="token literal-property property">capture</span><span class="token operator">:</span> <span class="token string">&#39;viewport&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p><h4 id="测试结果-2" tabindex="-1"><a class="header-anchor" href="#测试结果-2" aria-hidden="true">#</a> 测试结果</h4><figure><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200927184944595-957045456.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="capture-runner-的栗子" tabindex="-1"><a class="header-anchor" href="#capture-runner-的栗子" aria-hidden="true">#</a> capture:runner 的栗子</h3><h4 id="测试代码-3" tabindex="-1"><a class="header-anchor" href="#测试代码-3" aria-hidden="true">#</a> 测试代码</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>cy<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     <span class="token literal-property property">capture</span><span class="token operator">:</span> <span class="token string">&#39;runner&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p><h4 id="测试结果-3" tabindex="-1"><a class="header-anchor" href="#测试结果-3" aria-hidden="true">#</a> 测试结果</h4><figure><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200927184932384-871583946.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="screenshot-命令日志" tabindex="-1"><a class="header-anchor" href="#screenshot-命令日志" aria-hidden="true">#</a> .screenshot() 命令日志</h2><p><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200928085830543-589955926.png" alt="" loading="lazy"><br>  可以看到各配置项（options）的默认值</p><h2 id="onbeforescreenshot-的栗子" tabindex="-1"><a class="header-anchor" href="#onbeforescreenshot-的栗子" aria-hidden="true">#</a> onBeforeScreenshot 的栗子</h2><h3 id="截图某个元素" tabindex="-1"><a class="header-anchor" href="#截图某个元素" aria-hidden="true">#</a> 截图某个元素</h3><h4 id="测试代码-4" tabindex="-1"><a class="header-anchor" href="#测试代码-4" aria-hidden="true">#</a> 测试代码</h4><figure><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200928103524014-1754107427.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="测试结果-4" tabindex="-1"><a class="header-anchor" href="#测试结果-4" aria-hidden="true">#</a> 测试结果</h4><p><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200928103528842-1338380678.png" alt="" loading="lazy"><br> $el 是当前元素</p><h4 id="截图结果" tabindex="-1"><a class="header-anchor" href="#截图结果" aria-hidden="true">#</a> 截图结果</h4><figure><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200928103559205-1752489582.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="截图整个页面" tabindex="-1"><a class="header-anchor" href="#截图整个页面" aria-hidden="true">#</a> 截图整个页面</h3><h4 id="测试代码-5" tabindex="-1"><a class="header-anchor" href="#测试代码-5" aria-hidden="true">#</a> 测试代码</h4><figure><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200928103623590-1568579976.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="测试结果-5" tabindex="-1"><a class="header-anchor" href="#测试结果-5" aria-hidden="true">#</a> 测试结果</h4><p><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200928103633690-81793974.png" alt="" loading="lazy"><br> $el 是页面根标签</p><h2 id="onafterscreenshot-的栗子" tabindex="-1"><a class="header-anchor" href="#onafterscreenshot-的栗子" aria-hidden="true">#</a> onAfterScreenshot 的栗子</h2><h3 id="截图某个元素-1" tabindex="-1"><a class="header-anchor" href="#截图某个元素-1" aria-hidden="true">#</a> 截图某个元素</h3><h4 id="测试代码-6" tabindex="-1"><a class="header-anchor" href="#测试代码-6" aria-hidden="true">#</a> 测试代码</h4><figure><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200928104732355-294744892.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="测试结果-6" tabindex="-1"><a class="header-anchor" href="#测试结果-6" aria-hidden="true">#</a> 测试结果</h4><p><img src="https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200928104737969-655149890.png" alt="" loading="lazy"><br> 可以看到 props 是当前的一些属性，后面有需要可以获取对应的属性值（格式：props.path）</p><h4 id="onafterscreenshot-源码" tabindex="-1"><a class="header-anchor" href="#onafterscreenshot-源码" aria-hidden="true">#</a> onAfterScreenshot 源码</h4>`,72),d=n("img",{src:"https://img2020.cnblogs.com/blog/1896874/202009/1896874-20200928104758140-995193044.png",alt:"",loading:"lazy"},null,-1),h=n("br",null,null,-1),u=n("br",null,null,-1),g=n("br",null,null,-1),b=n("br",null,null,-1),m={href:"https://docs.cypress.io/api/commands/screenshot.html#after-screenshot-plugin-event",target:"_blank",rel:"noopener noreferrer"},f={href:"https://www.cnblogs.com/poloyy/p/13743099.html",target:"_blank",rel:"noopener noreferrer"};function k(v,x){const s=i("ExternalLinkIcon");return c(),o("div",null,[l,n("p",null,[d,h,a(" 可以看到不同属性的数据类型"),u,a("  "),g,a(" 待补充知识点链接"),b,n("a",m,[a("https://docs.cypress.io/api/commands/screenshot.html#after-screenshot-plugin-event"),e(s)])]),n("blockquote",null,[n("p",null,[n("a",f,[a("https://www.cnblogs.com/poloyy/p/13743099.html"),e(s)])])])])}const j=t(p,[["render",k],["__file","Cypress系列（060）--运行时的截图和录屏，screenshot()-命令详解.html.vue"]]);export{j as default};
