import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o,c as p,a as n,b as s,d as i,f as c}from"./app-207e7d61.js";const l={},u=c(`<h2 id="为什么需要cookie操作" tabindex="-1"><a class="header-anchor" href="#为什么需要cookie操作" aria-hidden="true">#</a> <strong>为什么需要Cookie操作</strong></h2><p>有时候我们需要验证浏览器中Cookie是否正确，因为基于真实Cookie的测试是无法通过白盒和集成测试进行的<br> 测试某些网站若需要先登录，可以直接通过接口去登录，把返回的Cookie存起来，相当于UI自动化上的免登录了，除开了不必要的登录操作</p><h2 id="有哪些cookie操作" tabindex="-1"><a class="header-anchor" href="#有哪些cookie操作" aria-hidden="true">#</a> 有哪些Cookie操作</h2><ul><li><p>get_cookies()： 获得所有cookie信息</p></li><li><p>get_cookie(name)： 返回字典的key=name的cookie信息</p></li><li><p>add_cookie(cookie_dict) ： 添加cookie</p></li><li><p>delete_cookie(name)：删除cookie信息name是要删除的cookie的名称</p></li><li><p>delete_all_cookies()： 删除所有cookie信息</p></li></ul><p></p><h2 id="直接上代码" tabindex="-1"><a class="header-anchor" href="#直接上代码" aria-hidden="true">#</a> 直接上代码</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># 浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token string">&quot;../resources/chromedriver.exe&quot;</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;https://px.seewo.com/product&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 获得网站的Cookies信息</span>
cookie <span class="token operator">=</span> driver<span class="token punctuation">.</span>get_cookies<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 将获得Cookies的信息打印</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span>

<span class="token comment"># 发起登录请求</span>

<span class="token comment"># 登录后存放的两个token，需要添加到Cookie中去</span>
cookie_list <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
cookies<span class="token punctuation">[</span><span class="token string">&quot;px-token&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> exchangedToken
cookies<span class="token punctuation">[</span><span class="token string">&quot;x-token&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> token

<span class="token comment"># 添加Cookie</span>
<span class="token keyword">for</span> cookie_ <span class="token keyword">in</span> cookies<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    driver<span class="token punctuation">.</span>add_cookie<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span> cookie_<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">:</span> cookie_<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;path&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;httpOnly&#39;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">&#39;secure&#39;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 再次打印Cookie</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>get_cookies<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 执行UI自动化操作</span>
<span class="token comment"># ......</span>
<span class="token comment"># ......</span>

<span class="token comment"># 发起退出登录请求</span>

<span class="token comment"># 删除某个Cookie</span>
driver<span class="token punctuation">.</span>delete_cookie<span class="token punctuation">(</span><span class="token string">&quot;x-token&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 删除所有Cookie</span>
driver<span class="token punctuation">.</span>delete_all_cookies<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 浏览器关闭</span>
driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看看， get_cookies()  返回的数据是什么样的</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&#39;domain&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;.training.test.seewo.com&#39;</span>, <span class="token string">&#39;httpOnly&#39;</span><span class="token builtin class-name">:</span> False, <span class="token string">&#39;name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;Hm_lpvt_b195036baa8d1a75b4e9572ee8593bdd&#39;</span>, <span class="token string">&#39;path&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;/&#39;</span>, <span class="token string">&#39;secure&#39;</span><span class="token builtin class-name">:</span> False, <span class="token string">&#39;value&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;1586141195&#39;</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;domain&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;.training.test.seewo.com&#39;</span>, <span class="token string">&#39;expiry&#39;</span><span class="token builtin class-name">:</span> <span class="token number">1617677195</span>, <span class="token string">&#39;httpOnly&#39;</span><span class="token builtin class-name">:</span> False, <span class="token string">&#39;name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;Hm_lvt_b195036baa8d1a75b4e9572ee8593bdd&#39;</span>, <span class="token string">&#39;path&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;/&#39;</span>, <span class="token string">&#39;secure&#39;</span><span class="token builtin class-name">:</span> False, <span class="token string">&#39;value&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;1586141195&#39;</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;domain&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;training.test.seewo.com&#39;</span>, <span class="token string">&#39;expiry&#39;</span><span class="token builtin class-name">:</span> <span class="token number">1586227594.128949</span>, <span class="token string">&#39;httpOnly&#39;</span><span class="token builtin class-name">:</span> True, <span class="token string">&#39;name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;connect.magick&#39;</span>, <span class="token string">&#39;path&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;/&#39;</span>, <span class="token string">&#39;secure&#39;</span><span class="token builtin class-name">:</span> False, <span class="token string">&#39;value&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;s%3AyLzNW4COEHLgiVSDtpv1pcUKzKmsMpoj.5mQxyZpM9kUEdsqXTyCFoht%2F3avDA20S%2Foz5jB52G7U&#39;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p></p><h2 id="源码解读" tabindex="-1"><a class="header-anchor" href="#源码解读" aria-hidden="true">#</a> 源码解读</h2><figure><img src="https://img2020.cnblogs.com/blog/1896874/202004/1896874-20200406102052434-567029752.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="知识点" tabindex="-1"><a class="header-anchor" href="#知识点" aria-hidden="true">#</a> 知识点</h3><ul><li><strong>get_cookie</strong>：从get_cookies()返回的Cookie列表中，循环判断，获取对应的Cookie</li><li><strong>add_cookie</strong>：传入dict对象，有两个必传key值：name、vlaue；五个可选key值：path、domain、secure、expiry、httpOnly；可以看到你的字典对象不能乱传key，否则会报错</li><li><strong>delete_cookie</strong>：传入的是Cookie的name值</li></ul><p></p>`,15),k={href:"https://www.cnblogs.com/poloyy/p/12640783.html",target:"_blank",rel:"noopener noreferrer"};function r(d,m){const a=t("ExternalLinkIcon");return o(),p("div",null,[u,n("blockquote",null,[n("p",null,[s("转载： "),n("a",k,[s("https://www.cnblogs.com/poloyy/p/12640783.html"),i(a)])])])])}const g=e(l,[["render",r],["__file","Selenium系列（21）---Cookie操作和源码解读.html.vue"]]);export{g as default};
