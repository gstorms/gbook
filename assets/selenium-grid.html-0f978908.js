import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as l,c as p,a,b as s,d as e,w as d,f as t}from"./app-207e7d61.js";const c={},u={href:"https://www.selenium.dev/documentation/grid/",target:"_blank",rel:"noopener noreferrer"},h=a("strong",null,"Google Chrome",-1),b=a("strong",null,"Microsoft Edge",-1),m={class:"hint-container note"},v=a("p",{class:"hint-container-title"},"æ³¨",-1),g={href:"https://www.selenium.dev/documentation/webdriver/",target:"_blank",rel:"noopener noreferrer"},k={href:"https://github.com/SeleniumHQ/selenium/tree/trunk/javascript/node/selenium-webdriver/example",target:"_blank",rel:"noopener noreferrer"},E=a("code",null,"SELENIUM_REMOTE_URL",-1),_={href:"https://github.com/SeleniumHQ/selenium/issues",target:"_blank",rel:"noopener noreferrer"},w=t(`<h2 id="starting-selenium-grid" tabindex="-1"><a class="header-anchor" href="#starting-selenium-grid" aria-hidden="true">#</a> Starting Selenium Grid</h2><p>If you run distributed Selenium Grid, Playwright needs selenium nodes to be registered with an accessible address, so that it could connect to the browsers. To make sure it works as expected, set <code>SE_NODE_GRID_URL</code> environment variable pointing to the hub when running selenium nodes.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Start selenium node</span>
<span class="token assign-left variable">SE_NODE_GRID_URL</span><span class="token operator">=</span><span class="token string">&quot;http://&lt;selenium-hub-ip&gt;:4444/wd/hub&quot;</span> <span class="token function">java</span> <span class="token parameter variable">-jar</span> selenium-server-<span class="token operator">&lt;</span>version<span class="token operator">&gt;</span>.jar <span class="token function">node</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="connecting-playwright-to-selenium-grid" tabindex="-1"><a class="header-anchor" href="#connecting-playwright-to-selenium-grid" aria-hidden="true">#</a> Connecting Playwright to Selenium Grid</h2><p>To connect Playwright to <strong>Selenium Grid 4</strong>, set <code>SELENIUM_REMOTE_URL</code> environment variable pointing to your Selenium Grid Hub. Note that this only works for Google Chrome and Microsoft Edge.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub npx playwright <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub pytest <span class="token parameter variable">--browser</span> chromium
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub mvn <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub dotnet <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>You don&#39;t have to change your code, just use your testing harness or [<code>method: BrowserType.launch</code>] as usual.</p>`,10),f=t(`<h3 id="passing-additional-capabilities" tabindex="-1"><a class="header-anchor" href="#passing-additional-capabilities" aria-hidden="true">#</a> Passing additional capabilities</h3><p>If your grid requires additional capabilities to be set (for example, you use an external service), you can set <code>SELENIUM_REMOTE_CAPABILITIES</code> environment variable to provide JSON-serialized capabilities.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub <span class="token assign-left variable">SELENIUM_REMOTE_CAPABILITIES</span><span class="token operator">=</span><span class="token string">&quot;{&#39;mygrid:options&#39;:{os:&#39;windows&#39;,username:&#39;John&#39;,password:&#39;secure&#39;}}&quot;</span> npx playwright <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub <span class="token assign-left variable">SELENIUM_REMOTE_CAPABILITIES</span><span class="token operator">=</span><span class="token string">&quot;{&#39;mygrid:options&#39;:{os:&#39;windows&#39;,username:&#39;John&#39;,password:&#39;secure&#39;}}&quot;</span> pytest <span class="token parameter variable">--browser</span> chromium
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub <span class="token assign-left variable">SELENIUM_REMOTE_CAPABILITIES</span><span class="token operator">=</span><span class="token string">&quot;{&#39;mygrid:options&#39;:{os:&#39;windows&#39;,username:&#39;John&#39;,password:&#39;secure&#39;}}&quot;</span> mvn <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub <span class="token assign-left variable">SELENIUM_REMOTE_CAPABILITIES</span><span class="token operator">=</span><span class="token string">&quot;{&#39;mygrid:options&#39;:{os:&#39;windows&#39;,username:&#39;John&#39;,password:&#39;secure&#39;}}&quot;</span> dotnet <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="detailed-logs" tabindex="-1"><a class="header-anchor" href="#detailed-logs" aria-hidden="true">#</a> Detailed logs</h3><p>Run with <code>DEBUG=pw:browser*</code> environment variable to see how Playwright is connecting to Selenium Grid.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">DEBUG</span><span class="token operator">=</span>pw:browser* <span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://internal.grid:4444/wd/hub npx playwright <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">DEBUG</span><span class="token operator">=</span>pw:browser* <span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://internal.grid:4444/wd/hub pytest <span class="token parameter variable">--browser</span> chromium
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">DEBUG</span><span class="token operator">=</span>pw:browser* <span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://internal.grid:4444/wd/hub mvn <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">DEBUG</span><span class="token operator">=</span>pw:browser* <span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://internal.grid:4444/wd/hub dotnet <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>If you file an issue, please include this log.</p><h2 id="using-selenium-docker" tabindex="-1"><a class="header-anchor" href="#using-selenium-docker" aria-hidden="true">#</a> Using Selenium Docker</h2>`,14),S={href:"https://github.com/SeleniumHQ/docker-selenium",target:"_blank",rel:"noopener noreferrer"},R={href:"https://github.com/seleniumhq-community/docker-seleniarm",target:"_blank",rel:"noopener noreferrer"},U=t(`<h3 id="standalone-mode" tabindex="-1"><a class="header-anchor" href="#standalone-mode" aria-hidden="true">#</a> Standalone mode</h3><p>Here is an example of running selenium standalone and connecting Playwright to it. Note that hub and node are on the same <code>localhost</code>, and we pass <code>SE_NODE_GRID_URL</code> environment variable pointing to it.</p><p>First start Selenium.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">4444</span>:4444 --shm-size<span class="token operator">=</span><span class="token string">&quot;2g&quot;</span> <span class="token parameter variable">-e</span> <span class="token assign-left variable">SE_NODE_GRID_URL</span><span class="token operator">=</span><span class="token string">&quot;http://localhost:4444/wd/hub&quot;</span> selenium/standalone-chrome:4.3.0-20220726

<span class="token comment"># Alternatively for arm architecture</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">4444</span>:4444 --shm-size<span class="token operator">=</span><span class="token string">&quot;2g&quot;</span> <span class="token parameter variable">-e</span> <span class="token assign-left variable">SE_NODE_GRID_URL</span><span class="token operator">=</span><span class="token string">&quot;http://localhost:4444/wd/hub&quot;</span> seleniarm/standalone-chromium:103.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Then run Playwright.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://localhost:4444/wd/hub npx playwright <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://localhost:4444/wd/hub pytest <span class="token parameter variable">--browser</span> chromium
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://localhost:4444/wd/hub mvn <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://localhost:4444/wd/hub dotnet <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="hub-and-nodes-mode" tabindex="-1"><a class="header-anchor" href="#hub-and-nodes-mode" aria-hidden="true">#</a> Hub and nodes mode</h3><p>Here is an example of running selenium hub and a single selenium node, and connecting Playwright to the hub. Note that hub and node have different IPs, and we pass <code>SE_NODE_GRID_URL</code> environment variable pointing to the hub when starting node containers.</p><p>First start the hub container and one or more node containers.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">4442</span>-4444:4442-4444 <span class="token parameter variable">--name</span> selenium-hub selenium/hub:4.3.0-20220726
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">5555</span>:5555 <span class="token punctuation">\\</span>
    --shm-size<span class="token operator">=</span><span class="token string">&quot;2g&quot;</span> <span class="token punctuation">\\</span>
    <span class="token parameter variable">-e</span> <span class="token assign-left variable">SE_EVENT_BUS_HOST</span><span class="token operator">=</span><span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span> <span class="token punctuation">\\</span>
    <span class="token parameter variable">-e</span> <span class="token assign-left variable">SE_EVENT_BUS_PUBLISH_PORT</span><span class="token operator">=</span><span class="token number">4442</span> <span class="token punctuation">\\</span>
    <span class="token parameter variable">-e</span> <span class="token assign-left variable">SE_EVENT_BUS_SUBSCRIBE_PORT</span><span class="token operator">=</span><span class="token number">4443</span> <span class="token punctuation">\\</span>
    <span class="token parameter variable">-e</span> <span class="token assign-left variable">SE_NODE_GRID_URL</span><span class="token operator">=</span><span class="token string">&quot;http://&lt;selenium-hub-ip&gt;:4444/wd/hub&quot;</span>
    selenium/node-chrome:4.3.0-20220726

<span class="token comment"># Alternatively for arm architecture</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">4442</span>-4444:4442-4444 <span class="token parameter variable">--name</span> selenium-hub seleniarm/hub:4.3.0-20220728
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">5555</span>:5555 <span class="token punctuation">\\</span>
    --shm-size<span class="token operator">=</span><span class="token string">&quot;2g&quot;</span> <span class="token punctuation">\\</span>
    <span class="token parameter variable">-e</span> <span class="token assign-left variable">SE_EVENT_BUS_HOST</span><span class="token operator">=</span><span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span> <span class="token punctuation">\\</span>
    <span class="token parameter variable">-e</span> <span class="token assign-left variable">SE_EVENT_BUS_PUBLISH_PORT</span><span class="token operator">=</span><span class="token number">4442</span> <span class="token punctuation">\\</span>
    <span class="token parameter variable">-e</span> <span class="token assign-left variable">SE_EVENT_BUS_SUBSCRIBE_PORT</span><span class="token operator">=</span><span class="token number">4443</span> <span class="token punctuation">\\</span>
    <span class="token parameter variable">-e</span> <span class="token assign-left variable">SE_NODE_GRID_URL</span><span class="token operator">=</span><span class="token string">&quot;http://&lt;selenium-hub-ip&gt;:4444/wd/hub&quot;</span>
    seleniarm/node-chromium:103.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Then run Playwright.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub npx playwright <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub pytest <span class="token parameter variable">--browser</span> chromium
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub mvn <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">SELENIUM_REMOTE_URL</span><span class="token operator">=</span>http://<span class="token operator">&lt;</span>selenium-hub-ip<span class="token operator">&gt;</span>:4444/wd/hub dotnet <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="selenium-3" tabindex="-1"><a class="header-anchor" href="#selenium-3" aria-hidden="true">#</a> Selenium 3</h2>`,19),L={href:"https://chromedevtools.github.io/devtools-protocol/",target:"_blank",rel:"noopener noreferrer"},I=a("p",null,"This means that Selenium 3 is supported in a best-effort manner, where Playwright tries to connect to the grid node directly. Grid nodes must be directly accessible from the machine that runs Playwright.",-1);function M(x,y){const n=i("ExternalLinkIcon"),r=i("RouterLink");return l(),p("div",null,[a("p",null,[s("Playwright can connect to "),a("a",u,[s("Selenium Grid Hub"),e(n)]),s(" that runs Selenium 4 to launch "),h,s(" or "),b,s(" browser, instead of running browser on the local machine.")]),a("div",m,[v,a("p",null,[s("Before connecting Playwright to your Selenium Grid, make sure that grid works with "),a("a",g,[s("Selenium WebDriver"),e(n)]),s(". For example, run "),a("a",k,[s("one of the examples"),e(n)]),s(" and pass "),E,s(" environment variable.")]),a("p",null,[s("If webdriver example does not work, look for any errors at your Selenium hub/node/standalone output and search "),a("a",_,[s("Selenium issues"),e(n)]),s(" for a possible solution.")])]),w,a("p",null,[s("When using Selenium Grid Hub, you can "),e(r,{to:"/book/playwright/browsers.html#skip-browser-downloads"},{default:d(()=>[s("skip browser downloads")]),_:1}),s(".")]),f,a("p",null,[s("One easy way to use Selenium Grid is to run official docker containers. Read more in "),a("a",S,[s("selenium docker images"),e(n)]),s(" documentation. For experimental arm images, see "),a("a",R,[s("docker-seleniarm"),e(n)]),s(".")]),U,a("p",null,[s("Internally, Playwright connects to the browser using "),a("a",L,[s("Chrome DevTools Protocol"),e(n)]),s(" websocket. Selenium 4 exposes this capability, while Selenium 3 does not.")]),I])}const O=o(c,[["render",M],["__file","selenium-grid.html.vue"]]);export{O as default};
